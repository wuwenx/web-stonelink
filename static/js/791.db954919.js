"use strict";(self["webpackChunkweb_stonelink"]=self["webpackChunkweb_stonelink"]||[]).push([[791],{8128:function(e,l,a){function t(e,l=2){if(null==e||""===e)return l;const a=String(e);return a.includes(".")?a.split(".")[1].length:Number(a)>=1?0:l}a.d(l,{$:function(){return t}})},1791:function(e,l,a){a.r(l),a.d(l,{default:function(){return N}});a(3842),a(6175),a(9865),a(1397),a(8797);var t=a(587),u=a(2651),r=a(8674),s=a(9844),n=a(3283),i=a(9931),o=a(415),c=a(5850),d=a(6329),p=a(8128);const b={class:"symbol-detail-container"},v={class:"card-header"},g={class:"header-left"},h={class:"page-title"},k={class:"header-right"},m={class:"control-group"},f={class:"control-group"},_={class:"slippage-controls"},y={class:"input-group"},F={class:"input-label"},x={class:"input-group"},w={class:"input-group"},L={class:"input-group"},P={class:"action-buttons"},S={class:"price-text"},C={class:"price-text"},W={class:"time-text"};var T={__name:"SymbolDetail",setup(e){const l=(0,i.lq)(),a=(0,i.rd)(),T=(0,c.w)(),V=(0,d.V)(),$=(0,u.KR)("BTCUSDT"),N=(0,u.KR)("BTCUSDT"),K=(0,u.KR)("buy"),z=(0,u.KR)(!1),D=(0,u.KR)("--"),A=(0,u.KR)(1),R=(0,u.KR)([]),I=(0,u.KR)(!1),E=(0,u.KR)("market"),U=(0,u.KR)("none"),q=(0,u.KR)(.1),X=(0,t.EW)(()=>V.symbolList.map(e=>({label:e,value:e}))),B=(0,t.EW)(()=>V.getSymbolInfo(N.value)),M=(0,t.EW)(()=>(0,p.$)(B.value?.quote_precision,2)),O=(0,t.EW)(()=>(0,p.$)(B.value?.base_asset_precision,5)),j=[{label:"万1(0.01%)",value:1e-4},{label:"万5(0.05%)",value:5e-4},{label:"微观(0.1%)",value:.001},{label:"紧密(0.5%)",value:.005},{label:"核心(1%)",value:.01},{label:"巨额(2%)",value:.02},{label:"大额(5%)",value:.05},{label:"极限(10%)",value:.1}],G=(0,t.EW)(()=>T.compareExchanges),H=(0,t.EW)(()=>{const e=G.value,l=T.config.exchangeType;return e.map(e=>{const a=T.getDepthData($.value,e),t=(0,o.Ny)(e,l),u={exchangeId:e,exchangeName:t,spreadPercent:a.spreadPercent||0};for(const l of j){const e=`${l.value}`,t=a.depthStats?.[e];"buy"===K.value?u[`depth_${l.value}`]=t?.bidDepth||0:u[`depth_${l.value}`]=t?.askDepth||0}return u})}),J=()=>{if(A.value&&!(A.value<=0)){I.value=!0;try{const e=[],l=G.value,a=T.config.exchangeType;for(const t of l){const l=T.getDepthData($.value,t),u=(0,o.Ny)(t,a);if(l&&l.asks&&l.bids){const a=Q(l.asks,A.value,"buy",E.value,U.value,q.value),r=Q(l.bids,A.value,"sell",E.value,U.value,q.value),s=a.averagePrice-r.averagePrice;e.push({exchangeId:t,exchangeName:u,buySlippage:a.slippagePercent,sellSlippage:r.slippagePercent,buyAvgPrice:a.averagePrice,sellAvgPrice:r.averagePrice,totalCost:s*A.value,executionTime:a.executionTime+r.executionTime})}else e.push({exchangeId:t,exchangeName:u,buySlippage:0,sellSlippage:0,buyAvgPrice:0,sellAvgPrice:0,totalCost:0,executionTime:0})}R.value=e}catch(e){console.error("滑点计算错误:",e)}finally{I.value=!1}}},Q=(e,l,a,t,u,r)=>{if(!e||0===e.length)return{slippagePercent:0,averagePrice:0,startPrice:0,finalPrice:0,executionTime:0};const s=e[0].price;let n=0,i=0,o=s,c=0;if("limit"===t){const l="buy"===a?s*(1+r/100):s*(1-r/100),t=e.filter(e=>"buy"===a?e.price<=l:e.price>=l);if(0===t.length)return{slippagePercent:0,averagePrice:l,startPrice:s,finalPrice:l,executionTime:0};e=t}let d=[];if("equal"===u){const e=3,a=l/e;d=Array(e).fill(a)}else if("smart"===u){const a=e.reduce((e,l)=>e+l.quantity,0);d=e.slice(0,5).map(e=>{const t=e.quantity/a;return l*t}).filter(e=>e>0)}else d=[l];for(const v of d){let l=v;for(const a of e){if(l<=0)break;const e=a.price,t=a.quantity,u=Math.min(l,t);n+=u*e,i+=u,l-=u,o=e,c+=10+40*Math.random()}d.length>1&&(c+=100+200*Math.random())}const p=i>0?n/i:s,b="buy"===a?(p-s)/s*100:(s-p)/s*100;return{slippagePercent:Math.abs(b),averagePrice:p,startPrice:s,finalPrice:o,executionTime:Math.round(c)}},Y=()=>{if(J(),R.value.length>0){const e=R.value.reduce((e,l)=>l.buySlippage<e.buySlippage?l:e),l=R.value.reduce((e,l)=>l.sellSlippage<e.sellSlippage?l:e);n.nk.success({message:`最优买入: ${e.exchangeName} (滑点 ${e.buySlippage.toFixed(4)}%) | 最优卖出: ${l.exchangeName} (滑点 ${l.sellSlippage.toFixed(4)}%)`,duration:5e3})}},Z=()=>{D.value=(new Date).toLocaleTimeString()},ee=()=>{a.push("/multi-depth")},le=e=>{$.value=e,N.value=e,T.subscribeSymbol(e),J()},ae=e=>{K.value=e,T.updateOrderSide(e)},te=e=>{const l={Binance:"warning",Toobit:"success",OKX:"primary"};return l[e]||"info"},ue=e=>e<.01?"success":e<.05?"warning":"danger",re=e=>e>100?"success":e>10?"warning":"danger",se=e=>{if(!e||0===e)return"--";const l=O.value;return e>=1e6?`${(e/1e6).toFixed(l)}M`:e>=1e3?`${(e/1e3).toFixed(l)}K`:Number(e).toFixed(l)},ne=e=>e&&0!==e?`${e.toFixed(4)}%`:"0.0000%",ie=e=>e&&0!==e?`${e.toFixed(4)} %`:"0.0000 %",oe=e=>e&&0!==e?Number(e).toFixed(M.value):"--",ce=e=>{if(!e||0===e)return"0.00";const l=e>0?"+":"";return`${l}${Number(e).toFixed(M.value)}`},de=e=>e<.05?"success":e<.1?"warning":"danger",pe=({row:e,column:l,rowIndex:a,columnIndex:t})=>0===t?{backgroundColor:"var(--el-fill-color-light)",fontWeight:"bold"}:{},be=()=>({backgroundColor:"var(--el-fill-color-light)",color:"var(--el-text-color-primary)",fontWeight:"bold",textAlign:"center"});let ve=null;return(0,t.sV)(()=>{const e=l.params.symbol||"BTCUSDT";V.symbolList.includes(e)?($.value=e,N.value=e):V.symbolList.length>0?($.value=V.symbolList[0],N.value=V.symbolList[0]):($.value=e,N.value=e),K.value=T.config.orderSide,T.isConnected||T.connect(),J(),ve=setInterval(()=>{Z(),J()},1e3)}),(0,t.hi)(()=>{ve&&(clearInterval(ve),ve=null)}),(0,t.wB)(()=>T.depthData,()=>{Z()},{deep:!0}),(0,t.wB)(()=>V.symbolList,e=>{e.length>0&&!e.includes(N.value)&&(N.value=e[0],$.value=e[0])},{immediate:!0}),(e,l)=>{const a=(0,t.g2)("el-button"),n=(0,t.g2)("el-tag"),i=(0,t.g2)("el-card"),o=(0,t.g2)("el-option"),c=(0,t.g2)("el-select"),d=(0,t.g2)("el-col"),p=(0,t.g2)("el-radio-button"),T=(0,t.g2)("el-radio-group"),V=(0,t.g2)("el-row"),B=(0,t.g2)("el-input-number"),M=(0,t.g2)("el-table-column"),O=(0,t.g2)("el-table"),G=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",b,[(0,t.bF)(i,{class:"header-card",shadow:"hover"},{header:(0,t.k6)(()=>[(0,t.Lk)("div",v,[(0,t.Lk)("div",g,[(0,t.bF)(a,{type:"primary",icon:(0,u.R1)(s.ArrowLeft),size:"small",onClick:ee},{default:(0,t.k6)(()=>[...l[6]||(l[6]=[(0,t.eW)(" 返回 ",-1)])]),_:1},8,["icon"]),(0,t.Lk)("h2",h,(0,r.v_)($.value)+" 单币对详情 ",1)]),(0,t.Lk)("div",k,[(0,t.bF)(n,{type:"info",size:"small"},{default:(0,t.k6)(()=>[(0,t.eW)(" 更新时间: "+(0,r.v_)(D.value),1)]),_:1})])])]),_:1}),(0,t.bF)(i,{class:"control-card",shadow:"hover"},{header:(0,t.k6)(()=>[...l[7]||(l[7]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("span",{class:"card-title"},"控制面板")],-1)])]),default:(0,t.k6)(()=>[(0,t.bF)(V,{gutter:20},{default:(0,t.k6)(()=>[(0,t.bF)(d,{span:4},{default:(0,t.k6)(()=>[(0,t.Lk)("div",m,[l[8]||(l[8]=(0,t.Lk)("label",{class:"control-label"},"交易对",-1)),(0,t.bF)(c,{modelValue:N.value,"onUpdate:modelValue":l[0]||(l[0]=e=>N.value=e),placeholder:"选择交易对",onChange:le},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(X.value,e=>((0,t.uX)(),(0,t.Wv)(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),(0,t.bF)(d,{span:12},{default:(0,t.k6)(()=>[(0,t.Lk)("div",f,[l[11]||(l[11]=(0,t.Lk)("label",{class:"control-label"},"订单方向",-1)),(0,t.bF)(T,{modelValue:K.value,"onUpdate:modelValue":l[1]||(l[1]=e=>K.value=e),onChange:ae},{default:(0,t.k6)(()=>[(0,t.bF)(p,{label:"buy"},{default:(0,t.k6)(()=>[...l[9]||(l[9]=[(0,t.eW)(" 买盘 ",-1)])]),_:1}),(0,t.bF)(p,{label:"sell"},{default:(0,t.k6)(()=>[...l[10]||(l[10]=[(0,t.eW)(" 卖盘 ",-1)])]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1}),(0,t.bF)(i,{class:"slippage-card",shadow:"hover"},{header:(0,t.k6)(()=>[...l[12]||(l[12]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("span",{class:"card-title"},"高级滑点模拟")],-1)])]),default:(0,t.k6)(()=>[(0,t.Lk)("div",_,[(0,t.bF)(V,{gutter:20},{default:(0,t.k6)(()=>[(0,t.bF)(d,{span:6},{default:(0,t.k6)(()=>[(0,t.Lk)("div",y,[(0,t.Lk)("label",F,"交易数量 ("+(0,r.v_)($.value.replace("USDT",""))+")",1),(0,t.bF)(B,{modelValue:A.value,"onUpdate:modelValue":l[2]||(l[2]=e=>A.value=e),min:.001,max:1e3,precision:3,step:.1,size:"large",onChange:J},null,8,["modelValue"])])]),_:1}),(0,t.bF)(d,{span:6},{default:(0,t.k6)(()=>[(0,t.Lk)("div",x,[l[13]||(l[13]=(0,t.Lk)("label",{class:"input-label"},"订单类型",-1)),(0,t.bF)(c,{modelValue:E.value,"onUpdate:modelValue":l[3]||(l[3]=e=>E.value=e),size:"large",onChange:J},{default:(0,t.k6)(()=>[(0,t.bF)(o,{label:"市价单",value:"market"}),(0,t.bF)(o,{label:"限价单",value:"limit"})]),_:1},8,["modelValue"])])]),_:1}),(0,t.bF)(d,{span:6},{default:(0,t.k6)(()=>[(0,t.Lk)("div",w,[l[14]||(l[14]=(0,t.Lk)("label",{class:"input-label"},"订单拆分",-1)),(0,t.bF)(c,{modelValue:U.value,"onUpdate:modelValue":l[4]||(l[4]=e=>U.value=e),size:"large",onChange:J},{default:(0,t.k6)(()=>[(0,t.bF)(o,{label:"不拆分",value:"none"}),(0,t.bF)(o,{label:"平均拆分",value:"equal"}),(0,t.bF)(o,{label:"智能拆分",value:"smart"})]),_:1},8,["modelValue"])])]),_:1}),(0,t.bF)(d,{span:6},{default:(0,t.k6)(()=>[(0,t.Lk)("div",L,[l[15]||(l[15]=(0,t.Lk)("label",{class:"input-label"},"限价偏移 (%)",-1)),(0,t.bF)(B,{modelValue:q.value,"onUpdate:modelValue":l[5]||(l[5]=e=>q.value=e),min:0,max:5,precision:2,step:.01,size:"large",disabled:"limit"!==E.value,onChange:J},null,8,["modelValue","disabled"])])]),_:1})]),_:1}),(0,t.Lk)("div",P,[(0,t.bF)(a,{type:"primary",size:"large",onClick:J},{default:(0,t.k6)(()=>[...l[16]||(l[16]=[(0,t.eW)(" 计算滑点 ",-1)])]),_:1}),(0,t.bF)(a,{type:"success",size:"large",onClick:Y},{default:(0,t.k6)(()=>[...l[17]||(l[17]=[(0,t.eW)(" 对比所有交易所 ",-1)])]),_:1})])]),(0,t.bo)(((0,t.uX)(),(0,t.Wv)(O,{data:R.value,border:"",class:"slippage-table"},{default:(0,t.k6)(()=>[(0,t.bF)(M,{prop:"exchange",label:"交易所",width:"120",align:"center"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(n,{type:te(e.exchangeName),size:"large"},{default:(0,t.k6)(()=>[(0,t.eW)((0,r.v_)(e.exchangeName),1)]),_:2},1032,["type"])]),_:1}),(0,t.bF)(M,{prop:"buySlippage",label:"买入滑点",width:"150",align:"center"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(n,{type:de(e.buySlippage),size:"large"},{default:(0,t.k6)(()=>[(0,t.eW)((0,r.v_)(ie(e.buySlippage)),1)]),_:2},1032,["type"])]),_:1}),(0,t.bF)(M,{prop:"sellSlippage",label:"卖出滑点",width:"150",align:"center"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(n,{type:de(e.sellSlippage),size:"large"},{default:(0,t.k6)(()=>[(0,t.eW)((0,r.v_)(ie(e.sellSlippage)),1)]),_:2},1032,["type"])]),_:1}),(0,t.bF)(M,{prop:"buyAvgPrice",label:"买入均价",width:"150",align:"center"},{default:(0,t.k6)(({row:e})=>[(0,t.Lk)("span",S,(0,r.v_)(oe(e.buyAvgPrice)),1)]),_:1}),(0,t.bF)(M,{prop:"sellAvgPrice",label:"卖出均价",width:"150",align:"center"},{default:(0,t.k6)(({row:e})=>[(0,t.Lk)("span",C,(0,r.v_)(oe(e.sellAvgPrice)),1)]),_:1}),(0,t.bF)(M,{prop:"totalCost",label:"总成本",width:"150",align:"center"},{default:(0,t.k6)(({row:e})=>[(0,t.Lk)("span",{class:(0,r.C4)(["cost-text",e.totalCost>0?"negative":"positive"])},(0,r.v_)(ce(e.totalCost)),3)]),_:1}),(0,t.bF)(M,{prop:"executionTime",label:"预计执行时间",width:"150",align:"center"},{default:(0,t.k6)(({row:e})=>[(0,t.Lk)("span",W,(0,r.v_)(e.executionTime)+"ms",1)]),_:1})]),_:1},8,["data"])),[[G,I.value]])]),_:1}),(0,t.bF)(i,{class:"table-card",shadow:"hover"},{header:(0,t.k6)(()=>[...l[18]||(l[18]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("span",{class:"card-title"},"流动性数据")],-1)])]),default:(0,t.k6)(()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(O,{data:H.value,border:"",class:"liquidity-table","cell-style":pe,"header-cell-style":be},{default:(0,t.k6)(()=>[(0,t.bF)(M,{prop:"exchangeName",label:"交易所",width:"150",align:"center"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(n,{type:te(e.exchangeName),size:"small"},{default:(0,t.k6)(()=>[(0,t.eW)((0,r.v_)(e.exchangeName),1)]),_:2},1032,["type"])]),_:1}),(0,t.bF)(M,{prop:"spreadPercent",label:"价差%",width:"120",align:"center"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(n,{type:ue(e.spreadPercent),size:"small",effect:"dark"},{default:(0,t.k6)(()=>[(0,t.eW)((0,r.v_)(ne(e.spreadPercent)),1)]),_:2},1032,["type"])]),_:1}),((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(j,e=>(0,t.bF)(M,{key:e.value,prop:`depth_${e.value}`,label:e.label,width:"120",align:"center"},{default:(0,t.k6)(({row:l})=>[(0,t.bF)(n,{type:re(l[`depth_${e.value}`]),size:"small"},{default:(0,t.k6)(()=>[(0,t.eW)((0,r.v_)(se(l[`depth_${e.value}`])),1)]),_:2},1032,["type"])]),_:2},1032,["prop","label"])),64))]),_:1},8,["data"])),[[G,z.value]])]),_:1})])}}},V=a(9190);const $=(0,V.A)(T,[["__scopeId","data-v-057b142a"]]);var N=$}}]);